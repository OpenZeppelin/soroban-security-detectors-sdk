metadata:
  id: return-default-struct
  uid: gg5HhJ
  description: If in a function, a default struct is created without `mut` modifier and then returned from the function with `unwrap_or` or with `return` or without being changed.
  report:
    severity: medium
    tags:
      - audit
      - reportable
      - completeness
    template:
      title: Return Default Struct Detected
      opening: Returning a default struct from a function without modification may indicate incomplete logic or unintended behavior. It is essential to ensure that functions return meaningful values rather than defaults.
      body-single-file-single-instance: In `$file_name`, the function `$FUNCTION_NAME` returns a default struct without modification.
      body-single-file-multiple-instance: In `$file_name`, multiple functions return a default struct without modification.
      body-multiple-file-multiple-instance: Across $total_files files, multiple functions return a default struct without modification.
      body-list-item-intro: 'The following functions were found returning a default struct without modification:'
      body-list-item-single-file: '- Function `$FUNCTION_NAME` in [`$file_name`]($instance_line_link)'
      body-list-item-multiple-file: '- Function `$FUNCTION_NAME` in [`$file_name`]($instance_line_link)'
      closing: To ensure proper functionality and usability, review the identified functions and modify them to return meaningful values rather than default structs. This will help prevent unintended behavior and improve code clarity.
